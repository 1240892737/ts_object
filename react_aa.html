<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <!-- 生产环境中不建议使用 -->
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script></head>
<body>
    <div id="example"></div>
    <script type="text/babel">
        //1.react开始
        ReactDOM.render(
            <h1>Hello,World!</h1>,
            document.getElementById('example')
        )
        //2.变量的循坏
        var arr = ['hahaha','lalala','aaa'];
        ReactDOM.render(
            <div>
            {
                arr.map(function(name){
                    return <div>Hello,{name}！</div>
                })
            }
            </div>,
            document.getElementById('example')
        )
        //3.变量自动解析
        arr = [<h1>Hello World!</h1>,<h2>React is awesome</h2>,]
        ReactDOM.render(
            <div>{arr}</div>,
            document.getElementById('example')
        )
        //4.组件
        //  createClass//老版本 ,最新使用es6
        // var HelloMessage = React.createClass({
        //     render: function(){
        //         return <h1>Hello , {this.props.name}</h1>
        //     }
        // });
        class HelloMessage extends React.Component{
            render(){
                return (
                    <h1>{this.props.name}</h1>
                )
            }
        }
        ReactDOM.render(
            <HelloMessage name='hzy'/>,
            document.getElementById('example')
        )
        //4.this.props.children
        class NotesList extends React.Component{
            render(){
                var a = 0;
                return <ol>
                {   
                    React.Children.map(this.props.children,function(child){
                        return <li key={'li_' + a++}>{child}</li>
                    })
                }
                </ol>
            }
        }
        ReactDOM.render(
            <NotesList>
                <span>hello</span>
                <span>world</span>
            </NotesList>,
            document.getElementById('example')
        )
        // 这里需要注意， this.props.children 的值有三种可能：如果当前组件没有子节点，它就是 undefined ;如果有一个子节点，数据类型是 object ；如果有多个子节点，数据类型就是 array 。所以，处理 this.props.children 的时候要小心。

        // React 提供一个工具方法 React.Children 来处理 this.props.children 。我们可以用 React.Children.map 来遍历子节点，而不用担心 this.props.children 的数据类型是 undefined 还是 object。更多的 React.Children 的方法，请参考官方文档。
        //6.PropTypes
        // 组件的属性可以接受任意值，字符串、对象、函数等等都可以。有时，我们需要一种机制，验证别人使用组件时，提供的参数是否符合要求。
        // var MyTitle = React.createClass({
        //     PropTypes:{
        //         title: React.PropTypes.string.isRequired,
        //     },
        //     getDefaultProps:function(){
        //         return {
        //             title:'hello world!'
        //         }
        //     },
        //     render:function(){
        //         return <h1>{this.props.title}</h1>
        //     }
        // });
        // //此外，getDefaultProps 方法可以用来设置组件属性的默认值。
        // var data = 1.2;
        // ReactDOM.render(
        //     <MyTitle />,
        //     document.getElementById('example')
        // )
        //7.获取真实的节点
        // 但是，有时需要从组件获取真实 DOM 的节点，这时就要用到 ref 属性（查看 demo07 ）。
        class MyComponent extends React.Component{
            constructor(props){
                super(props);
                this.handleClick = this.handleClick.bind(this);
            }
            render(){
                return (
                    <div>
                        <input type='text' ref='myText'/>
                        <input type='button' value='点击跳转到上面' onClick={this.handleClick}/>
                    </div>
                );
            }
            
            handleClick(){
                console.log()
                this.refs.myText.focus();
            };
        };
        ReactDOM.render(
            <MyComponent/>,
            document.getElementById('example')
        )

        //8. this.state 类似微信小程序的setData的方式
        class LikeButton extends React.Component{
            // constructor(props){
            //     super(props);
            //     this.liked = false
            // }
            getInitialState(){
                return {liked:false}
            }
            handleClick(event){
                this.setState({liked:!this.state.liked});
            }
            render(){
                var text = this.state.liked?'like':'haven\'t liked';
                return (
                    <p onClick={this.handleClick}>
                        You {text} this. Click to toggle
                    </p>
                )
            }
        }
        ReactDOM.render(
            <LikeButton />,
            document.getElementById('example')
        )

        //9.表单
        //用户在表单填入的内容，属于用户跟组件的互动，所以不能用 this.props 读取
        var Input = React.createClass({
            getInitialState: function(){
                return {value:'Hello!'}
            },
            handleClick:function(event){
                this.setState({value:event.target.value});
            },
            render:function(){
                var value = this.state.value;
                return (
                    <div>
                        <input type='text' value={value} onChange={this.handleClick}/>
                        <p>{value}</p>
                    </div>
                )
            }
        })
        ReactDOM.render(<Input />,document.getElementById('example'))

        //10. 生命周期
        // 组件的生命周期分成三个状态：

        //     Mounting：已插入真实 DOM
        //     Updating：正在被重新渲染
        //     Unmounting：已移出真实 DOM
        // React 为每个状态都提供了两种处理函数，will 函数在进入状态之前调用，did 函数在进入状态之后调用，三种状态共计五种处理函数。

        //     componentWillMount()
        //     componentDidMount()
        //     componentWillUpdate(object nextProps, object nextState)
        //     componentDidUpdate(object prevProps, object prevState)
        //     componentWillUnmount()
        //     此外，React 还提供两种特殊状态的处理函数。

        //     componentWillReceiveProps(object nextProps)：已加载组件收到新的参数时调用
        //     shouldComponentUpdate(object nextProps, object nextState)：组件判断是否重新渲染时调用
        // 另外，组件的style属性的设置方式也值得注意，不能写成
        var Hello = React.createClass({
            getInitialState:function(){
                return {opacity:1.0}
            },
            componentDidMount:function(){
                this.timer = setInterval(() => {
                    var opacity = this.state.opacity;
                    opacity -= 0.05;
                    if(opacity<0.1){
                        opacity=1;
                    }
                    this.setState({opacity:opacity});
                }, 100);
            },
            render:function(){
                return (
                    <div style={{opacity:this.state.opacity}}>
                        Hello {this.props.name}
                    </div>
                )
            }
        });
        ReactDOM.render(
            <Hello name='zhengan'/>,
            document.getElementById('example')
        )

        // style="opacity:{this.state.opacity};"
        // 而要写成


        // style={{opacity: this.state.opacity}}
    </script>
</body>
</html>
